#include <cstdint>
#include <random>
#include <emscripten.h>

using namespace std;

uint8_t* buffer_R = nullptr;
uint8_t* buffer_G = nullptr;
uint8_t* buffer_B = nullptr;
int im_width = 0, im_height = 0;

extern "C" {
    EMSCRIPTEN_KEEPALIVE
    float getModuleVersion(){
        return 3.1f;
    }
    
    EMSCRIPTEN_KEEPALIVE
    uint8_t* Rbuffer_init(int width, int height){
        buffer_R = (uint8_t*)malloc(width*height*sizeof(uint8_t));
        return buffer_R;
    }

    EMSCRIPTEN_KEEPALIVE
    uint8_t* Gbuffer_init(int width, int height){
        buffer_G = (uint8_t*)malloc(width*height*sizeof(uint8_t));
        return buffer_G;
    }

    EMSCRIPTEN_KEEPALIVE
    uint8_t* Bbuffer_init(int width, int height){
        buffer_B = (uint8_t*)malloc(width*height*sizeof(uint8_t));
        return buffer_B;
    }

    /*EMSCRIPTEN_KEEPALIVE
    bool setPixel(int x, uint8_t intensivity_R, uint8_t intensivity_G, uint8_t intensivity_B){
        if(x < im_width * im_height && x >= 0 && buffer_R != nullptr){
            buffer_R[x] = intensivity_R;
            buffer_G[x] = intensivity_G;
            buffer_B[x] = intensivity_B;
            return true;
        }
        return false;
    }

    EMSCRIPTEN_KEEPALIVE
    int getPixel(int x, char color){
        if(x < im_width * im_height && x >= 0 && buffer_R != nullptr){
            if(color_i == 0) return buffer_R[x];
            else if(color_i == 1) return buffer_G[x];
            else if(color_i == 2) {
                color_i = -1;
                return buffer_B[x];
            }
            color_i++;
        }
        return 0;
    }*/

    EMSCRIPTEN_KEEPALIVE
    void destroy_buffer(){
        free(buffer_R);
        free(buffer_G);
        free(buffer_B);
    }



    float DCT_Creator2[2][2] = {
            {0.707106781186548,	0.707106781186548},
            {0.707106781186548,	-0.707106781186548}
    };

    float DCT_Creator2_T[2][2] = {
            {0.707106781186548,	0.707106781186548},
            {0.707106781186548,	-0.707106781186548}
    };

    float DCT_Creator4[4][4] = {
            {0.500000000000000,	0.500000000000000,	0.500000000000000,	0.500000000000000},
            {0.653281482438188,	0.270598050073099,	-0.270598050073099,	-0.653281482438188},
            {0.500000000000000,	-0.500000000000000,	-0.500000000000000,	0.500000000000000},
            {0.270598050073099,	-0.653281482438188,	0.653281482438188,	-0.270598050073099}
    };

    float DCT_Creator4_T[4][4] = {
            {0.500000000000000,	0.653281482438188,	0.500000000000000,	0.270598050073099},
            {0.500000000000000,	0.270598050073099,	-0.500000000000000,	-0.653281482438188},
            {0.500000000000000,	-0.270598050073099,	-0.500000000000000,	0.653281482438188},
            {0.500000000000000,	-0.653281482438188,	0.500000000000000,	-0.270598050073099}
    };

    float DCT_Creator8[8][8] = {
            {0.3536, 0.3536, 0.3536, 0.3536, 0.3536, 0.3536, 0.3536, 0.3536},
            {0.4904, 0.4157, 0.2778, 0.0975, -0.0975, -0.2778, -0.4157, -0.4904},
            {0.4619, 0.1913, -0.1913, -0.4619, -0.4619, -0.1913, 0.1913, 0.4619},
            {0.4157, -0.0975, -0.4904, -0.2778, 0.2778, 0.4904, 0.0975, -0.4157},
            {0.3536, -0.3536, -0.3536, 0.3536, 0.3536, -0.3536, -0.3536, 0.3536},
            {0.2778, -0.4904, 0.0975, 0.4157, -0.4157, -0.0975, 0.4904, -0.2778},
            {0.1913, -0.4619, 0.4619, -0.1913, -0.1913, 0.4619, -0.4619, 0.1913},
            {0.0975, -0.2778, 0.4157, -0.4904, 0.4904, -0.4157, 0.2778, -0.0975}
    };

    float DCT_Creator8_T[8][8] = {
            {0.3536, 0.4904, 0.4619, 0.4157, 0.3536, 0.2778, 0.1913, 0.0975},
            {0.3536, 0.4157, 0.1913, -0.0975, -0.3536, -0.4904, -0.4619, -0.2778},
            {0.3536, 0.2778, -0.1913, -0.4904, -0.3536, 0.0975, 0.4619, 0.4157},
            {0.3536, 0.0975, -0.4619, -0.2778, 0.3536, 0.4157, -0.1913, -0.4904},
            {0.3536, -0.0975, -0.4619, 0.2778, 0.3536, -0.4157, -0.1913, 0.4904},
            {0.3536, -0.2778, -0.1913, 0.4904, -0.3536, -0.0975, 0.4619, -0.4157},
            {0.3536, -0.4157, 0.1913, 0.0975, -0.3536, 0.4904, -0.4619, 0.2778},
            {0.3536, -0.4904, 0.4619, -0.4157, 0.3536, -0.2778, 0.1913, -0.0975}
    };

    float DCT_Creator16[16][16] = {
            {0.250000000000000,	0.250000000000000,	  0.250000000000000,	0.250000000000000,	0.250000000000000,	 0.250000000000000,	 0.250000000000000,	 0.250000000000000,	 0.250000000000000,	  0.250000000000000,	0.250000000000000,	 0.250000000000000,	  0.250000000000000,	0.250000000000000,	  0.250000000000000,	0.250000000000000},
            {0.351850934381596,	0.338329500293588,	  0.311806253246668,	0.273300466750439,	0.224291896585659,	 0.166663914619437,	 0.102631131880589,	 0.0346542922997729, -0.0346542922997729, -0.102631131880589,	-0.166663914619437,	 -0.224291896585659,  -0.273300466750439,	-0.311806253246668,	  -0.338329500293588,	-0.351850934381596},
            {0.346759961330537,	0.293968900604840,	  0.196423739596776,	0.0689748448207358,	-0.0689748448207357, -0.196423739596775, -0.293968900604840, -0.346759961330537, -0.346759961330537,  -0.293968900604840,	-0.196423739596776,	 -0.0689748448207359, 0.0689748448207358,	0.196423739596775,	  0.293968900604840,	0.346759961330537},
            {0.338329500293588,	0.224291896585659,	  0.0346542922997729,	-0.166663914619437,	-0.311806253246668,	 -0.351850934381596, -0.273300466750439, -0.102631131880590, 0.102631131880590,	  0.273300466750439,	0.351850934381596,	 0.311806253246668,	  0.166663914619437,	-0.0346542922997726,  -0.224291896585659,	-0.338329500293588},
            {0.326640741219094,	0.135299025036549,	 -0.135299025036549,	-0.326640741219094,	-0.326640741219094,	 -0.135299025036549, 0.135299025036549,	 0.326640741219094,	 0.326640741219094,	  0.135299025036550,	-0.135299025036549,	 -0.326640741219094,  -0.326640741219094,	-0.135299025036550,	  0.135299025036549,	0.326640741219094},
            {0.311806253246668,	0.0346542922997729,	 -0.273300466750439,	-0.338329500293588,	-0.102631131880589,	 0.224291896585659,	 0.351850934381596,	 0.166663914619437,	 -0.166663914619437,  -0.351850934381596,	-0.224291896585659,	 0.102631131880589,	  0.338329500293588,	0.273300466750440,	  -0.0346542922997732,	-0.311806253246668},
            {0.293968900604840,	-0.0689748448207357, -0.346759961330537,	-0.196423739596776,	0.196423739596775,	 0.346759961330537,	 0.0689748448207356, -0.293968900604839, -0.293968900604840,  0.0689748448207354,	0.346759961330537,	 0.196423739596776,	  -0.196423739596775,	-0.346759961330537,	  -0.0689748448207364,	0.293968900604839},
            {0.273300466750439,	-0.166663914619437,	 -0.338329500293588,	0.0346542922997727,	0.351850934381596,	 0.102631131880590,	 -0.311806253246668, -0.224291896585660, 0.224291896585659,	  0.311806253246668,	-0.102631131880589,	 -0.351850934381596,  -0.0346542922997724,	0.338329500293588,	  0.166663914619437,	-0.273300466750439},
            {0.250000000000000,	-0.250000000000000,	 -0.250000000000000,	0.250000000000000,	0.250000000000000,	 -0.250000000000000, -0.250000000000000, 0.250000000000000,	 0.250000000000000,	  -0.250000000000000,	-0.250000000000000,	 0.250000000000000,	  0.250000000000000,	-0.250000000000000,	  -0.250000000000000,	0.250000000000000},
            {0.224291896585659,	-0.311806253246668,	 -0.102631131880589,	0.351850934381596,	-0.0346542922997726, -0.338329500293588, 0.166663914619437,	 0.273300466750440,	 -0.273300466750439,  -0.166663914619437,	0.338329500293588,	 0.0346542922997737,  -0.351850934381596,	0.102631131880589,	  0.311806253246668,	-0.224291896585659},
            {0.196423739596776,	-0.346759961330537,	  0.0689748448207358,	0.293968900604840,	-0.293968900604840,	 -0.0689748448207363,0.346759961330537,	 -0.196423739596775, -0.196423739596776,  0.346759961330537,	-0.0689748448207359, -0.293968900604840,  0.293968900604840,	0.0689748448207365,	  -0.346759961330537,	0.196423739596775},
            {0.166663914619437,	-0.351850934381596,	  0.224291896585659,	0.102631131880589,	-0.338329500293588,	 0.273300466750439,	 0.0346542922997723, -0.311806253246668, 0.311806253246668,	  -0.0346542922997718,	-0.273300466750439,	 0.338329500293588,	  -0.102631131880589,	-0.224291896585660,	  0.351850934381596,	-0.166663914619435},
            {0.135299025036549,	-0.326640741219094,	  0.326640741219094,	-0.135299025036549,	-0.135299025036550,	 0.326640741219094,	 -0.326640741219094, 0.135299025036548,	 0.135299025036549,	  -0.326640741219095,	0.326640741219094,	 -0.135299025036549,  -0.135299025036550,	0.326640741219095,	  -0.326640741219094,	0.135299025036548},
            {0.102631131880589,	-0.273300466750439,	  0.351850934381596,	-0.311806253246668,	0.166663914619437,	 0.0346542922997736, -0.224291896585659, 0.338329500293588,	 -0.338329500293588,  0.224291896585659,	-0.0346542922997730, -0.166663914619437,  0.311806253246668,	-0.351850934381596,	  0.273300466750439,	-0.102631131880588},
            {0.0689748448207358,-0.196423739596776,	  0.293968900604840,	-0.346759961330537,	0.346759961330537,	 -0.293968900604839, 0.196423739596776,	 -0.0689748448207346,-0.0689748448207352, 0.196423739596777,	-0.293968900604840,	 0.346759961330537,	  -0.346759961330537,	0.293968900604838,	  -0.196423739596775,	0.0689748448207343},
            {0.0346542922997729,-0.102631131880589,	  0.166663914619437,	-0.224291896585659,	0.273300466750440,	 -0.311806253246668, 0.338329500293588,	 -0.351850934381596, 0.351850934381596,	  -0.338329500293588,	0.311806253246668,	 -0.273300466750438,  0.224291896585659,	-0.166663914619435,	  0.102631131880589,	-0.0346542922997715}
    };

    float DCT_Creator16_T[16][16] = {
            {0.250000000000000,	0.351850934381596,	  0.346759961330537,	0.338329500293588,	 0.326640741219094,	  0.311806253246668,	0.293968900604840,	  0.273300466750439,	0.250000000000000,	0.224291896585659,	  0.196423739596776,	0.166663914619437,	 0.135299025036549,	    0.102631131880589,	 0.0689748448207358,	0.0346542922997729},
            {0.250000000000000,	0.338329500293588,	  0.293968900604840,	0.224291896585659,	 0.135299025036549,	  0.0346542922997729,	-0.0689748448207357,  -0.166663914619437,	-0.250000000000000,	-0.311806253246668,	  -0.346759961330537,	-0.351850934381596,	 -0.326640741219094,	-0.273300466750439,	 -0.196423739596776,	-0.102631131880589},
            {0.250000000000000,	0.311806253246668,	  0.196423739596776,	0.0346542922997729,	 -0.135299025036549,  -0.273300466750439,	-0.346759961330537,	  -0.338329500293588,	-0.250000000000000,	-0.102631131880589,	  0.0689748448207358,	0.224291896585659,	 0.326640741219094,	    0.351850934381596,	 0.293968900604840,	    0.166663914619437},
            {0.250000000000000,	0.273300466750439,	  0.0689748448207358,	-0.166663914619437,	 -0.326640741219094,  -0.338329500293588,	-0.196423739596776,	  0.0346542922997727,	0.250000000000000,	0.351850934381596,	  0.293968900604840,	0.102631131880589,	 -0.135299025036549,	-0.311806253246668,	 -0.346759961330537,	-0.224291896585659},
            {0.250000000000000,	0.224291896585659,	  -0.0689748448207357,	-0.311806253246668,	 -0.326640741219094,  -0.102631131880589,	0.196423739596775,	  0.351850934381596,	0.250000000000000,	-0.0346542922997726,  -0.293968900604840,	-0.338329500293588,	 -0.135299025036550,	0.166663914619437,	 0.346759961330537,	    0.273300466750440},
            {0.250000000000000,	0.166663914619437,	  -0.196423739596775,	-0.351850934381596,	 -0.135299025036549,  0.224291896585659,	0.346759961330537,	  0.102631131880590,    -0.250000000000000,	-0.338329500293588,	  -0.0689748448207363,	0.273300466750439,	 0.326640741219094,	    0.0346542922997736,	 -0.293968900604839,	-0.311806253246668},
            {0.250000000000000,	0.102631131880589,	  -0.293968900604840,	-0.273300466750439,	 0.135299025036549,	  0.351850934381596,	0.0689748448207356,	  -0.311806253246668,	-0.250000000000000,	0.166663914619437,    0.346759961330537,	0.0346542922997723,	 -0.326640741219094,	-0.224291896585659,	 0.196423739596776,	    0.338329500293588},
            {0.250000000000000,	0.0346542922997729,	  -0.346759961330537,	-0.102631131880590,	 0.326640741219094,	  0.166663914619437,	-0.293968900604839,	  -0.224291896585660,	0.250000000000000,	0.273300466750440,	  -0.196423739596775,	-0.311806253246668,	 0.135299025036548,	    0.338329500293588,	 -0.0689748448207346,	-0.351850934381596},
            {0.250000000000000,	-0.0346542922997729,  -0.346759961330537,	0.102631131880590,	 0.326640741219094,	  -0.166663914619437,	-0.293968900604840,	  0.224291896585659,	0.250000000000000,	-0.273300466750439,	  -0.196423739596776,	0.311806253246668,	 0.135299025036549,	    -0.338329500293588,	 -0.0689748448207352,	0.351850934381596},
            {0.250000000000000,	-0.102631131880589,	  -0.293968900604840,	0.273300466750439,	 0.135299025036550,	  -0.351850934381596,	0.0689748448207354,	  0.311806253246668,	-0.250000000000000,	-0.166663914619437,	  0.346759961330537,	-0.0346542922997718, -0.326640741219095,	0.224291896585659,	 0.196423739596777,	    -0.338329500293588},
            {0.250000000000000,	-0.166663914619437,	  -0.196423739596776,	0.351850934381596,	 -0.135299025036549,  -0.224291896585659,	0.346759961330537,	  -0.102631131880589,	-0.250000000000000,	0.338329500293588,	  -0.0689748448207359,	-0.273300466750439,	 0.326640741219094,	    -0.0346542922997730, -0.293968900604840,	0.311806253246668},
            {0.250000000000000,	-0.224291896585659,	  -0.0689748448207359,	0.311806253246668,	 -0.326640741219094,  0.102631131880589,	0.196423739596776,	  -0.351850934381596,	0.250000000000000,	0.0346542922997737,	  -0.293968900604840,	0.338329500293588,	 -0.135299025036549,	-0.166663914619437,	 0.346759961330537,	    -0.273300466750438},
            {0.250000000000000,	-0.273300466750439,	  0.0689748448207358,	0.166663914619437,	 -0.326640741219094,  0.338329500293588,	-0.196423739596775,	  -0.0346542922997724,	0.250000000000000,	-0.351850934381596,	  0.293968900604840,	-0.102631131880589,	 -0.135299025036550,	0.311806253246668,	 -0.346759961330537,	0.224291896585659},
            {0.250000000000000,	-0.311806253246668,	  0.196423739596775,	-0.0346542922997726, -0.135299025036550,  0.273300466750440,	-0.346759961330537,	  0.338329500293588,	-0.250000000000000,	0.102631131880589,	  0.0689748448207365,	-0.224291896585660,	 0.326640741219095,	    -0.351850934381596,	 0.293968900604838,	    -0.166663914619435},
            {0.250000000000000,	-0.338329500293588,	  0.293968900604840,	-0.224291896585659,	 0.135299025036549,	  -0.0346542922997732,	-0.0689748448207364,  0.166663914619437,	-0.250000000000000,	0.311806253246668,	  -0.346759961330537,	0.351850934381596,	 -0.326640741219094,	0.273300466750439,	 -0.196423739596775,	0.102631131880589},
            {0.250000000000000,	-0.351850934381596,	  0.346759961330537,	-0.338329500293588,	 0.326640741219094,	  -0.311806253246668,	0.293968900604839,	  -0.273300466750439,	0.250000000000000,	-0.224291896585659,	  0.196423739596775,	-0.166663914619435,	 0.135299025036548, 	-0.102631131880588,	 0.0689748448207343,	-0.0346542922997715}
    };

    float DCT_Creator32[32][32] = {
            {0.176776695296637,	0.176776695296637, 0.176776695296637, 0.176776695296637, 	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637,	0.176776695296637},
            {0.249698864051293,	0.247294127491195, 0.242507813298636, 0.235386016295755,	0.225997323280861,	0.214432152500068,	0.200801882870161,	0.185237781338740,	0.167889738711755,	0.148924826123108,	0.128525686048305,	0.106888773357571,	0.0842224633480550,	0.0607450449758160,	0.0366826186138404,	0.0122669185818545,	-0.0122669185818545,	-0.0366826186138404,	-0.0607450449758160,	-0.0842224633480550,	-0.106888773357570,	-0.128525686048305,	-0.148924826123108,	-0.167889738711755,	-0.185237781338740,	-0.200801882870161,	-0.214432152500068,	-0.225997323280861,	-0.235386016295755,	-0.242507813298636,	-0.247294127491195,	-0.249698864051293},
            {0.248796181668049,	0.239235083933052, 0.220480316087089, 0.193252613340684,	0.158598321040911,	0.117849184206499,	0.0725711693136156,	0.0245042850823902,	-0.0245042850823902,	-0.0725711693136155,	-0.117849184206499,	-0.158598321040911,	-0.193252613340684,	-0.220480316087089,	-0.239235083933052,	-0.248796181668049,	-0.248796181668049,	-0.239235083933052,	-0.220480316087089,	-0.193252613340684,	-0.158598321040911,	-0.117849184206499,	-0.0725711693136156,	-0.0245042850823901,	0.0245042850823900,	0.0725711693136155,	0.117849184206499,	0.158598321040911,	0.193252613340684,	0.220480316087089,	0.239235083933052,	0.248796181668049},
            {0.247294127491195,	0.225997323280861, 0.185237781338740, 0.128525686048305,	0.0607450449758160,	-0.0122669185818544,	-0.0842224633480550,	-0.148924826123108,	-0.200801882870161,	-0.235386016295755,	-0.249698864051293,	-0.242507813298636,	-0.214432152500068,	-0.167889738711755,	-0.106888773357571,	-0.0366826186138406,	0.0366826186138405,	0.106888773357571,	0.167889738711755,	0.214432152500068,	0.242507813298636,	0.249698864051293,	0.235386016295755,	0.200801882870161,	0.148924826123109,	0.0842224633480552,	0.0122669185818545,	-0.0607450449758161,	-0.128525686048305,	-0.185237781338740,	-0.225997323280861,	-0.247294127491195},
            {0.245196320100808,	0.207867403075636, 0.138892558254901, 0.0487725805040321,	-0.0487725805040321,	-0.138892558254901,	-0.207867403075636,	-0.245196320100808,	-0.245196320100808,	-0.207867403075636,	-0.138892558254901,	-0.0487725805040322,	0.0487725805040321,	0.138892558254900,	0.207867403075636,	0.245196320100808,	0.245196320100808,	0.207867403075636,	0.138892558254901,	0.0487725805040322,	-0.0487725805040318,	-0.138892558254900,	-0.207867403075636,	-0.245196320100808,	-0.245196320100808,	-0.207867403075636,	-0.138892558254901,	-0.0487725805040320,	0.0487725805040318,	0.138892558254900,	0.207867403075636,	0.245196320100808},
            {0.242507813298636,	0.185237781338740, 0.0842224633480550, -0.0366826186138404,	-0.148924826123108,	-0.225997323280861,	-0.249698864051293,	-0.214432152500068,	-0.128525686048305,	-0.0122669185818545,	0.106888773357571,	0.200801882870161,	0.247294127491195,	0.235386016295755,	0.167889738711755,	0.0607450449758161,	-0.0607450449758161,	-0.167889738711754,	-0.235386016295755,	-0.247294127491195,	-0.200801882870161,	-0.106888773357571,	0.0122669185818544,	0.128525686048306,	0.214432152500068,	0.249698864051293,	0.225997323280861,	0.148924826123108,	0.0366826186138409,	-0.0842224633480546,	-0.185237781338740,	-0.242507813298636},
            {0.239235083933052,	0.158598321040911, 0.0245042850823902, -0.117849184206499,	-0.220480316087089,	-0.248796181668049,	-0.193252613340684,	-0.0725711693136158,	0.0725711693136157,	0.193252613340684,	0.248796181668049,	0.220480316087089,	0.117849184206500,	-0.0245042850823900,	-0.158598321040911,	-0.239235083933052,	-0.239235083933052,	-0.158598321040911,	-0.0245042850823902,	0.117849184206499,	0.220480316087088,	0.248796181668049,	0.193252613340684,	0.0725711693136155,	-0.0725711693136152,	-0.193252613340684,	-0.248796181668049,	-0.220480316087089,	-0.117849184206500,	0.0245042850823903,	0.158598321040911,	0.239235083933052},
            {0.235386016295755,	0.128525686048305, -0.0366826186138404,	-0.185237781338740,	-0.249698864051293,	-0.200801882870161,	-0.0607450449758158,	0.106888773357570,	0.225997323280861,	0.242507813298636,	0.148924826123108,	-0.0122669185818544,	-0.167889738711755,	-0.247294127491195,	-0.214432152500068,	-0.0842224633480553,	0.0842224633480551,	0.214432152500068,	0.247294127491195,	0.167889738711755,	0.0122669185818550,	-0.148924826123108,	-0.242507813298636,	-0.225997323280861,	-0.106888773357571,	0.0607450449758156,	0.200801882870161,	0.249698864051293,	0.185237781338740,	0.0366826186138405,	-0.128525686048306,	-0.235386016295755},
            {0.230969883127822,	0.0956708580912725, -0.0956708580912724, -0.230969883127822,-0.230969883127822,	-0.0956708580912726,	0.0956708580912725,	0.230969883127822,	0.230969883127822,	0.0956708580912726,	-0.0956708580912725,	-0.230969883127822,	-0.230969883127822,	-0.0956708580912726,	0.0956708580912725,	0.230969883127822,	0.230969883127822,	0.0956708580912727,	-0.0956708580912724,	-0.230969883127822,	-0.230969883127822,	-0.0956708580912727,	0.0956708580912724,	0.230969883127822,	0.230969883127822,	0.0956708580912727,	-0.0956708580912724,	-0.230969883127822,	-0.230969883127822,	-0.0956708580912728,	0.0956708580912723,	0.230969883127822},
            {0.225997323280861,	0.0607450449758160,	-0.148924826123108, -0.249698864051293,	-0.167889738711755,	0.0366826186138403,	0.214432152500068,	0.235386016295755,	0.0842224633480550,	-0.128525686048305,	-0.247294127491195,	-0.185237781338740,	0.0122669185818544,	0.200801882870161,	0.242507813298636,	0.106888773357571,	-0.106888773357570,	-0.242507813298636,	-0.200801882870161,	-0.0122669185818546,	0.185237781338739,	0.247294127491195,	0.128525686048305,	-0.0842224633480554,	-0.235386016295755,	-0.214432152500068,	-0.0366826186138405,	0.167889738711755,	0.249698864051293,	0.148924826123109,	-0.0607450449758155,	-0.225997323280861},
            {0.220480316087089,	0.0245042850823902,	-0.193252613340684,	-0.239235083933052,	-0.0725711693136156,	0.158598321040911,	0.248796181668049,	0.117849184206500,	-0.117849184206499,	-0.248796181668049,	-0.158598321040911,	0.0725711693136153,	0.239235083933052,	0.193252613340684,	-0.0245042850823904,	-0.220480316087089,	-0.220480316087089,	-0.0245042850823907,	0.193252613340684,	0.239235083933052,	0.0725711693136160,	-0.158598321040911,	-0.248796181668049,	-0.117849184206499,	0.117849184206499,	0.248796181668049,	0.158598321040911,	-0.0725711693136155,	-0.239235083933052,	-0.193252613340685,	0.0245042850823902,	0.220480316087089},
            {0.214432152500068,	-0.0122669185818545, -0.225997323280861, -0.200801882870161,0.0366826186138405,	0.235386016295755,	0.185237781338740,	-0.0607450449758157,	-0.242507813298636,	-0.167889738711755,	0.0842224633480551,	0.247294127491195,	0.148924826123108,	-0.106888773357570,	-0.249698864051293,	-0.128525686048306,	0.128525686048306,	0.249698864051293,	0.106888773357570,	-0.148924826123108,	-0.247294127491195,	-0.0842224633480558,	0.167889738711755,	0.242507813298636,	0.0607450449758169,	-0.185237781338740,	-0.235386016295755,	-0.0366826186138406,	0.200801882870161,	0.225997323280861,	0.0122669185818539,	-0.214432152500068},
            {0.207867403075636,	-0.0487725805040321, -0.245196320100808, -0.138892558254901,0.138892558254900,	0.245196320100808,	0.0487725805040320,	-0.207867403075636,	-0.207867403075636,	0.0487725805040318,	0.245196320100808,	0.138892558254901,	-0.138892558254900,	-0.245196320100808,	-0.0487725805040325,	0.207867403075636,	0.207867403075636,	-0.0487725805040321,	-0.245196320100808,	-0.138892558254901,	0.138892558254900,	0.245196320100808,	0.0487725805040317,	-0.207867403075636,	-0.207867403075637,	0.0487725805040312,	0.245196320100808,	0.138892558254900,	-0.138892558254900,	-0.245196320100808,	-0.0487725805040327,	0.207867403075636},
            {0.200801882870161,	-0.0842224633480550, -0.249698864051293, -0.0607450449758160,0.214432152500068,	0.185237781338740,	-0.106888773357571,	-0.247294127491195,	-0.0366826186138404,	0.225997323280861,	0.167889738711755,	-0.128525686048305,	-0.242507813298636,	-0.0122669185818546,	0.235386016295755,	0.148924826123109,	-0.148924826123108,	-0.235386016295755,	0.0122669185818542,	0.242507813298636,	0.128525686048306,	-0.167889738711755,	-0.225997323280861,	0.0366826186138409,	0.247294127491195,	0.106888773357571,	-0.185237781338740,	-0.214432152500068,	0.0607450449758146,	0.249698864051293,	0.0842224633480551,	-0.200801882870161},
            {0.193252613340684,	-0.117849184206499,	-0.239235083933052,	0.0245042850823900,	0.248796181668049,	0.0725711693136159,	-0.220480316087089,	-0.158598321040912,	0.158598321040912,	0.220480316087089,	-0.0725711693136156,	-0.248796181668049,	-0.0245042850823898,	0.239235083933052,	0.117849184206500,	-0.193252613340684,	-0.193252613340684,	0.117849184206499,	0.239235083933052,	-0.0245042850823894,	-0.248796181668049,	-0.0725711693136161,	0.220480316087089,	0.158598321040912,	-0.158598321040910,	-0.220480316087089,	0.0725711693136154,	0.248796181668049,	0.0245042850823909,	-0.239235083933052,	-0.117849184206499,	0.193252613340685},
            {0.185237781338740,	-0.148924826123108,	-0.214432152500068,	0.106888773357571,	0.235386016295755,	-0.0607450449758157,	-0.247294127491195,	0.0122669185818544,	0.249698864051293,	0.0366826186138409,	-0.242507813298636,	-0.0842224633480557,	0.225997323280861,	0.128525686048306,	-0.200801882870161,	-0.167889738711755,	0.167889738711755,	0.200801882870161,	-0.128525686048306,	-0.225997323280861,	0.0842224633480545,	0.242507813298636,	-0.0366826186138409,	-0.249698864051293,	-0.0122669185818548, 0.247294127491195,	0.0607450449758170,	-0.235386016295755,	-0.106888773357572,	0.214432152500068,	0.148924826123109,	-0.185237781338740},
            {0.176776695296637,	-0.176776695296637,	-0.176776695296637,	0.176776695296637,	0.176776695296637,	-0.176776695296637,	-0.176776695296637,	0.176776695296637,	0.176776695296637,	-0.176776695296637,	-0.176776695296637,	0.176776695296637,	0.176776695296637,	-0.176776695296637,	-0.176776695296637,	0.176776695296637,	0.176776695296637,	-0.176776695296637,	-0.176776695296637,	0.176776695296637,	0.176776695296638,	-0.176776695296637,	-0.176776695296637,	0.176776695296637,	0.176776695296638,	-0.176776695296636,	-0.176776695296637,	0.176776695296637,	0.176776695296638	-0.176776695296636,	-0.176776695296637,	0.176776695296637},
            {0.167889738711755,	-0.200801882870161,	-0.128525686048305,	0.225997323280861,	0.0842224633480550, -0.242507813298636,	-0.0366826186138404,	0.249698864051293,	-0.0122669185818548,	-0.247294127491195,	0.0607450449758165,	0.235386016295755,	-0.106888773357571,	-0.214432152500068,	0.148924826123108,	0.185237781338740,	-0.185237781338740,	-0.148924826123109,	0.214432152500068,	0.106888773357571,	-0.235386016295755,	-0.0607450449758161,	0.247294127491195,	0.0122669185818540,	-0.249698864051293,	0.0366826186138399,	0.242507813298636,	-0.0842224633480552,	-0.225997323280861,	0.128525686048305,	0.200801882870161,	-0.167889738711754},
            {0.158598321040911,	-0.220480316087089,	-0.0725711693136156, 0.248796181668049,	-0.0245042850823900,	-0.239235083933052,	0.117849184206499,	0.193252613340684,	-0.193252613340684,	-0.117849184206500,	0.239235083933052,	0.0245042850823907,	-0.248796181668049,	0.0725711693136156,	0.220480316087089,	-0.158598321040911,	-0.158598321040911,	0.220480316087088,	0.0725711693136161,	-0.248796181668049,	0.0245042850823884,	0.239235083933052,	-0.117849184206500,	-0.193252613340684,	0.193252613340684,	0.117849184206500,	-0.239235083933052,	-0.0245042850823901,	0.248796181668049,	-0.0725711693136144, -0.220480316087089,	0.158598321040911},
            {0.148924826123108,	-0.235386016295755,	-0.0122669185818545, 0.242507813298636,	-0.128525686048305,	-0.167889738711755,	0.225997323280861,	0.0366826186138409,	-0.247294127491195,	0.106888773357570,	0.185237781338740,	-0.214432152500068,	-0.0607450449758160,	0.249698864051293,	-0.0842224633480553,	-0.200801882870161,	0.200801882870161,	0.0842224633480550,	-0.249698864051293,	0.0607450449758146,	0.214432152500068,	-0.185237781338739,	-0.106888773357571,	0.247294127491195,	-0.0366826186138390,	-0.225997323280861,	0.167889738711754,	0.128525686048305,	-0.242507813298636,	0.0122669185818530,	0.235386016295755,	-0.148924826123109},
            {0.138892558254901,	-0.245196320100808,	0.0487725805040321,	0.207867403075636,	-0.207867403075636,	-0.0487725805040324,	0.245196320100808,	-0.138892558254900,	-0.138892558254901,	0.245196320100808,	-0.0487725805040321,	-0.207867403075637,	0.207867403075636,	0.0487725805040326,	-0.245196320100808,	0.138892558254900,	0.138892558254900,	-0.245196320100807,	0.0487725805040311,	0.207867403075637,	-0.207867403075636,	-0.0487725805040327,	0.245196320100808,	-0.138892558254902,	-0.138892558254901,	0.245196320100808,	-0.0487725805040318,	-0.207867403075636,	0.207867403075635,	0.0487725805040338,	-0.245196320100808,	0.138892558254901},
            {0.128525686048305,	-0.249698864051293,	0.106888773357571, 0.148924826123108,	-0.247294127491195,	0.0842224633480546,	0.167889738711755,	-0.242507813298636,	0.0607450449758165,	0.185237781338740,	-0.235386016295755,	0.0366826186138401,	0.200801882870161,	-0.225997323280861,	0.0122669185818542,	0.214432152500068,	-0.214432152500068,	-0.0122669185818548,	0.225997323280861,	-0.200801882870161,	-0.0366826186138416,	0.235386016295755,	-0.185237781338740,	-0.0607450449758162,	0.242507813298636,	-0.167889738711754,	-0.0842224633480544,	0.247294127491195,	-0.148924826123107,	-0.106888773357571,	0.249698864051293,	-0.128525686048307},
            {0.117849184206499,	-0.248796181668049,	0.158598321040911, 0.0725711693136156,	-0.239235083933052,	0.193252613340684,	0.0245042850823898,	-0.220480316087089,	0.220480316087089,	-0.0245042850823894,	-0.193252613340684,	0.239235083933052,	-0.0725711693136155,	-0.158598321040912,	0.248796181668049,	-0.117849184206498,	-0.117849184206499,	0.248796181668049,	-0.158598321040912,	-0.0725711693136170,	0.239235083933053,	-0.193252613340683,	-0.0245042850823901,	0.220480316087089,	-0.220480316087088,	0.0245042850823900,	0.193252613340684,	-0.239235083933052,	0.0725711693136135,	0.158598321040912,	-0.248796181668049,	0.117849184206500},
            {0.106888773357571,	-0.242507813298636,	0.200801882870161, -0.0122669185818544,	-0.185237781338740,	0.247294127491195,	-0.128525686048306,	-0.0842224633480557,	0.235386016295755,	-0.214432152500068,	0.0366826186138401,	0.167889738711755,	-0.249698864051293,	0.148924826123108,	0.0607450449758152,	-0.225997323280861,	0.225997323280861,	-0.0607450449758154,	-0.148924826123108,	0.249698864051293,	-0.167889738711753,	-0.0366826186138417,	0.214432152500068,	-0.235386016295755,	0.0842224633480542,	0.128525686048306,	-0.247294127491195,	0.185237781338739,	0.0122669185818578,	-0.200801882870162,	0.242507813298636,	-0.106888773357571},
            {0.0956708580912725, -0.230969883127822, 0.230969883127822,	-0.0956708580912725,-0.0956708580912726,	0.230969883127822,	-0.230969883127822,	0.0956708580912716,	0.0956708580912719,	-0.230969883127822,	0.230969883127822,	-0.0956708580912723,	-0.0956708580912728,	0.230969883127822,	-0.230969883127821,	0.0956708580912714,	0.0956708580912721,	-0.230969883127822,	0.230969883127822,	-0.0956708580912721,	-0.0956708580912746,	0.230969883127822,	-0.230969883127822,	0.0956708580912729,	0.0956708580912739,	-0.230969883127822,	0.230969883127822,	-0.0956708580912736,	-0.0956708580912732,	0.230969883127821,	-0.230969883127821,	0.0956708580912727},
            {0.0842224633480550, -0.214432152500068, 0.247294127491195,	-0.167889738711754,	0.0122669185818544,	0.148924826123109,	-0.242507813298636,	0.225997323280861,	-0.106888773357571,	-0.0607450449758169,	0.200801882870161,	-0.249698864051293,	0.185237781338740,	-0.0366826186138391,	-0.128525686048306,	0.235386016295755,	-0.235386016295755,	0.128525686048305,	0.0366826186138408,	-0.185237781338741,	0.249698864051293,	-0.200801882870161,	0.0607450449758161,	0.106888773357570,	-0.225997323280862,	0.242507813298636,	-0.148924826123109,	-0.0122669185818533,	0.167889738711756,	-0.247294127491195,	0.214432152500068,	-0.0842224633480549},
            {0.0725711693136156, -0.193252613340684, 0.248796181668049,	-0.220480316087089,	0.117849184206499,	0.0245042850823906,	-0.158598321040911,	0.239235083933052,	-0.239235083933052,	0.158598321040911,	-0.0245042850823902,	-0.117849184206500,	0.220480316087089,	-0.248796181668049,	0.193252613340684,	-0.0725711693136146,	-0.0725711693136153,	0.193252613340684,	-0.248796181668049,	0.220480316087088,	-0.117849184206498,	-0.0245042850823902,	0.158598321040912,	-0.239235083933052,	0.239235083933052,	-0.158598321040910,	0.0245042850823916,	0.117849184206498,	-0.220480316087090,	0.248796181668049,	-0.193252613340684,	0.0725711693136150},
            {0.0607450449758160, -0.167889738711755, 0.235386016295755,	-0.247294127491195,	0.200801882870161,	-0.106888773357570,	-0.0122669185818546,	0.128525686048306,	-0.214432152500068,	0.249698864051293,	-0.225997323280861,	0.148924826123108,	-0.0366826186138409,	-0.0842224633480559,	0.185237781338740,	-0.242507813298636,	0.242507813298636,	-0.185237781338739,	0.0842224633480543,	0.0366826186138408,	-0.148924826123110,	0.225997323280861,	-0.249698864051293,	0.214432152500069,	-0.128525686048304,	0.0122669185818547,	0.106888773357572,	-0.200801882870161,	0.247294127491195,	-0.235386016295755,	0.167889738711755, -0.0607450449758150},
            {0.0487725805040321, -0.138892558254901, 0.207867403075636,	-0.245196320100808,	0.245196320100808,	-0.207867403075636,	0.138892558254901,	-0.0487725805040313, -0.0487725805040317,	0.138892558254901,	-0.207867403075636,	0.245196320100808,	-0.245196320100808,	0.207867403075635,	-0.138892558254900,	0.0487725805040311,	0.0487725805040319,	-0.138892558254901,	0.207867403075636,	-0.245196320100808,	0.245196320100807,	-0.207867403075636,	0.138892558254901,	-0.0487725805040317,	-0.0487725805040347,	0.138892558254902,	-0.207867403075636,	0.245196320100807,	-0.245196320100807,	0.207867403075636,	-0.138892558254901,	0.0487725805040341},
            {0.0366826186138404, -0.106888773357571, 0.167889738711755,	-0.214432152500068,	0.242507813298636,	-0.249698864051293,	0.235386016295755,	-0.200801882870161,	0.148924826123108,	-0.0842224633480545,	0.0122669185818551,	0.0607450449758169,	-0.128525686048306,	0.185237781338740,	-0.225997323280861,	0.247294127491195,	-0.247294127491195,	0.225997323280860,	-0.185237781338740,	0.128525686048305,	-0.0607450449758135,	-0.0122669185818551,	0.0842224633480553,	-0.148924826123108,	0.200801882870163,	-0.235386016295755,	0.249698864051293,	-0.242507813298636,	0.214432152500067,	-0.167889738711753,	0.106888773357569,	-0.0366826186138421},
            {0.0245042850823902, -0.0725711693136156, 0.117849184206500, -0.158598321040911,0.193252613340684,	-0.220480316087089,	0.239235083933052,	-0.248796181668049,	0.248796181668049,	-0.239235083933052,	0.220480316087089,	-0.193252613340683,	0.158598321040911,	-0.117849184206498,	0.0725711693136154,	-0.0245042850823892,	-0.0245042850823901,	0.0725711693136163,	-0.117849184206499,	0.158598321040912,	-0.193252613340685,	0.220480316087090,	-0.239235083933052,	0.248796181668049,	-0.248796181668049,	0.239235083933052,	-0.220480316087088,	0.193252613340685,	-0.158598321040909,	0.117849184206499,	-0.0725711693136141,	0.0245042850823914},
            {0.0122669185818545, -0.0366826186138406, 0.0607450449758161, -0.0842224633480553,	0.106888773357571,	-0.128525686048306,	0.148924826123108,	-0.167889738711755,	0.185237781338739,	-0.200801882870161,	0.214432152500068,	-0.225997323280861,	0.235386016295755,	-0.242507813298636,	0.247294127491195,	-0.249698864051293,	0.249698864051293,	-0.247294127491195,	0.242507813298636,	-0.235386016295755,	0.225997323280860,	-0.214432152500068,	0.200801882870160,	-0.185237781338740,	0.167889738711754,	-0.148924826123109,	0.128525686048304,	-0.106888773357571,	0.0842224633480539,	-0.0607450449758132,	0.0366826186138394,	-0.0122669185818553}
    };

    float DCT_Creator32_T[32][32] = {
            {0.176776695296637,	0.249698864051293,	0.248796181668049,	0.247294127491195,	0.245196320100808,	0.242507813298636,	0.239235083933052,	0.235386016295755,	0.230969883127822,	0.225997323280861,	0.220480316087089,	0.214432152500068,	0.207867403075636,	0.200801882870161,	0.193252613340684,	0.185237781338740,	0.176776695296637,	0.167889738711755,	0.158598321040911,	0.148924826123108,	0.138892558254901,	0.128525686048305,	0.117849184206499,	0.106888773357571,	0.0956708580912725,	0.0842224633480550,	0.0725711693136156,	0.0607450449758160,	0.0487725805040321,	0.0366826186138404,	0.0245042850823902,	0.0122669185818545},
            {0.176776695296637,	0.247294127491195,	0.239235083933052,	0.225997323280861,	0.207867403075636,	0.185237781338740,	0.158598321040911,	0.128525686048305,	0.0956708580912725,	0.0607450449758160,	0.0245042850823902,	-0.0122669185818545,-0.0487725805040321,-0.0842224633480550,-0.117849184206499,	-0.148924826123108,	-0.176776695296637,	-0.200801882870161,	-0.220480316087089,	-0.235386016295755,	-0.245196320100808,	-0.249698864051293,	-0.248796181668049,	-0.242507813298636,	-0.230969883127822,	-0.214432152500068,	-0.193252613340684,	-0.167889738711755,	-0.138892558254901,	-0.106888773357571,	-0.0725711693136156,-0.0366826186138406},
            {0.176776695296637,	0.242507813298636,	0.220480316087089,	0.185237781338740,	0.138892558254901,	0.0842224633480550,	0.0245042850823902,	-0.0366826186138404,-0.0956708580912724,-0.148924826123108,	-0.193252613340684,	-0.225997323280861,	-0.245196320100808,	-0.249698864051293,	-0.239235083933052,	-0.214432152500068,	-0.176776695296637,	-0.128525686048305,	-0.0725711693136156,-0.0122669185818545,0.0487725805040321,	0.106888773357571,	0.158598321040911,	0.200801882870161,	0.230969883127822,	0.247294127491195,	0.248796181668049,	0.235386016295755,	0.207867403075636,	0.167889738711755,	0.117849184206500,	0.0607450449758161},
            {0.176776695296637,	0.235386016295755,	0.193252613340684,	0.128525686048305,	0.0487725805040321,	-0.0366826186138404,-0.117849184206499,	-0.185237781338740,	-0.230969883127822,	-0.249698864051293,	-0.239235083933052,	-0.200801882870161,	-0.138892558254901,	-0.0607450449758160,0.0245042850823900,	0.106888773357571,	0.176776695296637,	0.225997323280861,	0.248796181668049,	0.242507813298636,	0.207867403075636,	0.148924826123108,	0.0725711693136156,	-0.0122669185818544,-0.0956708580912725,-0.167889738711754,	-0.220480316087089,	-0.247294127491195,	-0.245196320100808,	-0.214432152500068,	-0.158598321040911,	-0.0842224633480553},
            {0.176776695296637,	0.225997323280861,	0.158598321040911,	0.0607450449758160,	-0.0487725805040321,-0.148924826123108,	-0.220480316087089,	-0.249698864051293,	-0.230969883127822,	-0.167889738711755,	-0.0725711693136156,0.0366826186138405,	0.138892558254900,	0.214432152500068,	0.248796181668049,	0.235386016295755,	0.176776695296637,	0.0842224633480550,	-0.0245042850823900,-0.128525686048305,	-0.207867403075636,	-0.247294127491195,	-0.239235083933052,	-0.185237781338740,	-0.0956708580912726,0.0122669185818544,	0.117849184206499,	0.200801882870161,	0.245196320100808,	0.242507813298636,	0.193252613340684,	0.106888773357571},
            {0.176776695296637,	0.214432152500068,	0.117849184206499,	-0.0122669185818544,-0.138892558254901,	-0.225997323280861,	-0.248796181668049,	-0.200801882870161,	-0.0956708580912726,0.0366826186138403,	0.158598321040911,	0.235386016295755,	0.245196320100808,	0.185237781338740,	0.0725711693136159,	-0.0607450449758157,-0.176776695296637,	-0.242507813298636,	-0.239235083933052,	-0.167889738711755,	-0.0487725805040324,0.0842224633480546,	0.193252613340684,	0.247294127491195,	0.230969883127822,	0.148924826123109,	0.0245042850823906,	-0.106888773357570,	-0.207867403075636,	-0.249698864051293,	-0.220480316087089,	-0.128525686048306},
            {0.176776695296637,	0.200801882870161,	0.0725711693136156,	-0.0842224633480550,-0.207867403075636,	-0.249698864051293,	-0.193252613340684,	-0.0607450449758158,0.0956708580912725,	0.214432152500068,	0.248796181668049,	0.185237781338740,	0.0487725805040320,	-0.106888773357571,	-0.220480316087089,	-0.247294127491195,	-0.176776695296637,	-0.0366826186138404,0.117849184206499,	0.225997323280861,	0.245196320100808,	0.167889738711755,	0.0245042850823898,	-0.128525686048306,	-0.230969883127822,	-0.242507813298636,	-0.158598321040911,	-0.0122669185818546,0.138892558254901,	0.235386016295755,	0.239235083933052,	0.148924826123108},
            {0.176776695296637,	0.185237781338740,	0.0245042850823902,	-0.148924826123108,	-0.245196320100808,	-0.214432152500068,	-0.0725711693136158,0.106888773357570,	0.230969883127822,	0.235386016295755,	0.117849184206500,	-0.0607450449758157,-0.207867403075636,	-0.247294127491195,	-0.158598321040912,	0.0122669185818544,	0.176776695296637,	0.249698864051293,	0.193252613340684,	0.0366826186138409,	-0.138892558254900,	-0.242507813298636,	-0.220480316087089,	-0.0842224633480557,0.0956708580912716,	0.225997323280861,	0.239235083933052,	0.128525686048306,	-0.0487725805040313,-0.200801882870161,	-0.248796181668049,	-0.167889738711755},
            {0.176776695296637,	0.167889738711755,	-0.0245042850823902,-0.200801882870161,	-0.245196320100808,	-0.128525686048305,	0.0725711693136157,	0.225997323280861,	0.230969883127822,	0.0842224633480550,	-0.117849184206499,	-0.242507813298636,	-0.207867403075636,	-0.0366826186138404,0.158598321040912,	0.249698864051293,	0.176776695296637,	-0.0122669185818548,-0.193252613340684,	-0.247294127491195,	-0.138892558254901,	0.0607450449758165,	0.220480316087089,	0.235386016295755,	0.0956708580912719,	-0.106888773357571,	-0.239235083933052,	-0.214432152500068,	-0.0487725805040317,0.148924826123108,	0.248796181668049,	0.185237781338739},
            {0.176776695296637,	0.148924826123108,	-0.0725711693136155,-0.235386016295755,	-0.207867403075636,	-0.0122669185818545,0.193252613340684,	0.242507813298636,	0.0956708580912726,	-0.128525686048305,	-0.248796181668049,	-0.167889738711755,	0.0487725805040318,	0.225997323280861,	0.220480316087089,	0.0366826186138409,	-0.176776695296637,	-0.247294127491195,	-0.117849184206500,	0.106888773357570,	0.245196320100808,	0.185237781338740,	-0.0245042850823894,-0.214432152500068,	-0.230969883127822,	-0.0607450449758169,0.158598321040911,	0.249698864051293,	0.138892558254901,	-0.0842224633480545,-0.239235083933052,	-0.200801882870161},
            {0.176776695296637,	0.128525686048305,	-0.117849184206499,	-0.249698864051293,	-0.138892558254901,	0.106888773357571,	0.248796181668049,	0.148924826123108,	-0.0956708580912725,-0.247294127491195,	-0.158598321040911,	0.0842224633480551,	0.245196320100808,	0.167889738711755,	-0.0725711693136156,-0.242507813298636,	-0.176776695296637,	0.0607450449758165,	0.239235083933052,	0.185237781338740,	-0.0487725805040321,-0.235386016295755,	-0.193252613340684,	0.0366826186138401,	0.230969883127822,	0.200801882870161,	-0.0245042850823902,-0.225997323280861,	-0.207867403075636,	0.0122669185818551,	0.220480316087089,	0.214432152500068},
            {0.176776695296637,	0.106888773357571,	-0.158598321040911,	-0.242507813298636,	-0.0487725805040322,0.200801882870161,	0.220480316087089,	-0.0122669185818544,-0.230969883127822,	-0.185237781338740,	0.0725711693136153,	0.247294127491195,	0.138892558254901,	-0.128525686048305,	-0.248796181668049,	-0.0842224633480557,0.176776695296637,	0.235386016295755,	0.0245042850823907,	-0.214432152500068,	-0.207867403075637,	0.0366826186138401,	0.239235083933052,	0.167889738711755,	-0.0956708580912723,-0.249698864051293,	-0.117849184206500,	0.148924826123108,	0.245196320100808,	0.0607450449758169,	-0.193252613340683,	-0.225997323280861},
            {0.176776695296637,	0.0842224633480550,	-0.193252613340684,	-0.214432152500068,	0.0487725805040321,	0.247294127491195,	0.117849184206500,	-0.167889738711755,	-0.230969883127822,	0.0122669185818544,	0.239235083933052,	0.148924826123108,	-0.138892558254900,	-0.242507813298636,	-0.0245042850823898,0.225997323280861,	0.176776695296637,	-0.106888773357571,	-0.248796181668049,	-0.0607450449758160,0.207867403075636,	0.200801882870161,	-0.0725711693136155,-0.249698864051293,	-0.0956708580912728,0.185237781338740,	0.220480316087089,	-0.0366826186138409,-0.245196320100808,	-0.128525686048306,	0.158598321040911,	0.235386016295755},
            {0.176776695296637,	0.0607450449758160,	-0.220480316087089,	-0.167889738711755,	0.138892558254900,	0.235386016295755,	-0.0245042850823900,-0.247294127491195,	-0.0956708580912726,0.200801882870161,	0.193252613340684,	-0.106888773357570,	-0.245196320100808,	-0.0122669185818546,0.239235083933052,	0.128525686048306,	-0.176776695296637,	-0.214432152500068,	0.0725711693136156,	0.249698864051293,	0.0487725805040326,	-0.225997323280861,	-0.158598321040912,	0.148924826123108,	0.230969883127822,	-0.0366826186138391,-0.248796181668049,	-0.0842224633480559,0.207867403075635,	0.185237781338740,	-0.117849184206498,	-0.242507813298636},
            {0.176776695296637,	0.0366826186138404,	-0.239235083933052,	-0.106888773357571,	0.207867403075636,	0.167889738711755,	-0.158598321040911,	-0.214432152500068,	0.0956708580912725,	0.242507813298636,	-0.0245042850823904,-0.249698864051293,	-0.0487725805040325,0.235386016295755,	0.117849184206500,	-0.200801882870161,	-0.176776695296637,	0.148924826123108,	0.220480316087089,	-0.0842224633480553,-0.245196320100808,	0.0122669185818542,	0.248796181668049,	0.0607450449758152,	-0.230969883127821,	-0.128525686048306,	0.193252613340684,	0.185237781338740,	-0.138892558254900,	-0.225997323280861,	0.0725711693136154,	0.247294127491195},
            {0.176776695296637,	0.0122669185818545,	-0.248796181668049,	-0.0366826186138406,0.245196320100808,	0.0607450449758161,	-0.239235083933052,	-0.0842224633480553,0.230969883127822,	0.106888773357571,	-0.220480316087089,	-0.128525686048306,	0.207867403075636,	0.148924826123109,	-0.193252613340684,	-0.167889738711755,	0.176776695296637,	0.185237781338740,	-0.158598321040911,	-0.200801882870161,	0.138892558254900,	0.214432152500068,	-0.117849184206498,	-0.225997323280861,	0.0956708580912714,	0.235386016295755,	-0.0725711693136146,-0.242507813298636,	0.0487725805040311,	0.247294127491195,	-0.0245042850823892,-0.249698864051293},
            {0.176776695296637,	-0.0122669185818545,-0.248796181668049,	0.0366826186138405,	0.245196320100808,	-0.0607450449758161,-0.239235083933052,	0.0842224633480551,	0.230969883127822,	-0.106888773357570,	-0.220480316087089,	0.128525686048306,	0.207867403075636,	-0.148924826123108,	-0.193252613340684,	0.167889738711755,	0.176776695296637,	-0.185237781338740,	-0.158598321040911,	0.200801882870161,	0.138892558254900,	-0.214432152500068,	-0.117849184206499,	0.225997323280861,	0.0956708580912721,	-0.235386016295755,	-0.0725711693136153,0.242507813298636,	0.0487725805040319,	-0.247294127491195,	-0.0245042850823901,0.249698864051293},
            {0.176776695296637,	-0.0366826186138404,-0.239235083933052,	0.106888773357571,	0.207867403075636,	-0.167889738711754,	-0.158598321040911,	0.214432152500068,	0.0956708580912727,	-0.242507813298636,	-0.0245042850823907,0.249698864051293,	-0.0487725805040321,-0.235386016295755,	0.117849184206499,	0.200801882870161,	-0.176776695296637,	-0.148924826123109,	0.220480316087088,	0.0842224633480550,	-0.245196320100807,	-0.0122669185818548,0.248796181668049,	-0.0607450449758154,-0.230969883127822,	0.128525686048305,	0.193252613340684,	-0.185237781338739,	-0.138892558254901,	0.225997323280860,	0.0725711693136163,	-0.247294127491195},
            {0.176776695296637,	-0.0607450449758160,-0.220480316087089,	0.167889738711755,	0.138892558254901,	-0.235386016295755,	-0.0245042850823902,0.247294127491195,	-0.0956708580912724,-0.200801882870161,	0.193252613340684,	0.106888773357570,	-0.245196320100808,	0.0122669185818542,	0.239235083933052,	-0.128525686048306,	-0.176776695296637,	0.214432152500068,	0.0725711693136161,	-0.249698864051293,	0.0487725805040311,	0.225997323280861,	-0.158598321040912,	-0.148924826123108,	0.230969883127822,	0.0366826186138408,	-0.248796181668049,	0.0842224633480543,	0.207867403075636,	-0.185237781338740,	-0.117849184206499,	0.242507813298636},
            {0.176776695296637,	-0.0842224633480550,-0.193252613340684,	0.214432152500068,	0.0487725805040322,	-0.247294127491195,	0.117849184206499,	0.167889738711755,	-0.230969883127822,	-0.0122669185818546,0.239235083933052,	-0.148924826123108,	-0.138892558254901,	0.242507813298636,	-0.0245042850823894,-0.225997323280861,	0.176776695296637,	0.106888773357571,	-0.248796181668049,	0.0607450449758146,	0.207867403075637,	-0.200801882870161,	-0.0725711693136170,0.249698864051293,	-0.0956708580912721,-0.185237781338741,	0.220480316087088,	0.0366826186138408,	-0.245196320100808,	0.128525686048305,	0.158598321040912,	-0.235386016295755},
            {0.176776695296637,	-0.106888773357570,	-0.158598321040911,	0.242507813298636,	-0.0487725805040318,-0.200801882870161,	0.220480316087088,	0.0122669185818550,	-0.230969883127822,	0.185237781338739,	0.0725711693136160,	-0.247294127491195,	0.138892558254900,	0.128525686048306,	-0.248796181668049,	0.0842224633480545,	0.176776695296638,	-0.235386016295755,	0.0245042850823884,	0.214432152500068,	-0.207867403075636,	-0.0366826186138416,0.239235083933053,	-0.167889738711753,	-0.0956708580912746,0.249698864051293,	-0.117849184206498,	-0.148924826123110,	0.245196320100807,	-0.0607450449758135,-0.193252613340685,	0.225997323280860},
            {0.176776695296637,	-0.128525686048305,	-0.117849184206499,	0.249698864051293,	-0.138892558254900,	-0.106888773357571,	0.248796181668049,	-0.148924826123108,	-0.0956708580912727,0.247294127491195,	-0.158598321040911,	-0.0842224633480558,0.245196320100808,	-0.167889738711755,	-0.0725711693136161,0.242507813298636,	-0.176776695296637,	-0.0607450449758161,0.239235083933052,	-0.185237781338739,	-0.0487725805040327,0.235386016295755,	-0.193252613340683,	-0.0366826186138417,0.230969883127822,	-0.200801882870161,	-0.0245042850823902,0.225997323280861,	-0.207867403075636,	-0.0122669185818551,0.220480316087090,	-0.214432152500068},
            {0.176776695296637,	-0.148924826123108,	-0.0725711693136156,0.235386016295755,	-0.207867403075636,	0.0122669185818544,	0.193252613340684,	-0.242507813298636,	0.0956708580912724,	0.128525686048305,	-0.248796181668049,	0.167889738711755,	0.0487725805040317,	-0.225997323280861,	0.220480316087089,	-0.0366826186138409,-0.176776695296637,	0.247294127491195,	-0.117849184206500,	-0.106888773357571,	0.245196320100808,	-0.185237781338740,	-0.0245042850823901,0.214432152500068,	-0.230969883127822,	0.0607450449758161,	0.158598321040912,	-0.249698864051293,	0.138892558254901,	0.0842224633480553,	-0.239235083933052,	0.200801882870160},
            {0.176776695296637,	-0.167889738711755,	-0.0245042850823901,0.200801882870161,	-0.245196320100808,	0.128525686048306,	0.0725711693136155,	-0.225997323280861,	0.230969883127822,	-0.0842224633480554,-0.117849184206499,	0.242507813298636,	-0.207867403075636,	0.0366826186138409,	0.158598321040912,	-0.249698864051293,	0.176776695296637,	0.0122669185818540,	-0.193252613340684,	0.247294127491195,	-0.138892558254902,	-0.0607450449758162,0.220480316087089,	-0.235386016295755,	0.0956708580912729,	0.106888773357570,	-0.239235083933052,	0.214432152500069,	-0.0487725805040317,-0.148924826123108,	0.248796181668049,	-0.185237781338740},
            {0.176776695296637,	-0.185237781338740,	0.0245042850823900,	0.148924826123109,	-0.245196320100808,	0.214432152500068,	-0.0725711693136152,-0.106888773357571,	0.230969883127822,	-0.235386016295755,	0.117849184206499,	0.0607450449758169,	-0.207867403075637,	0.247294127491195,	-0.158598321040910,	-0.0122669185818548,0.176776695296638,	-0.249698864051293,	0.193252613340684,	-0.0366826186138390,-0.138892558254901,	0.242507813298636,	-0.220480316087088,	0.0842224633480542,	0.0956708580912739,	-0.225997323280862,	0.239235083933052,	-0.128525686048304,	-0.0487725805040347,0.200801882870163,	-0.248796181668049,	0.167889738711754},
            {0.176776695296637,	-0.200801882870161,	0.0725711693136155,	0.0842224633480552,	-0.207867403075636,	0.249698864051293,	-0.193252613340684,	0.0607450449758156,	0.0956708580912727,	-0.214432152500068,	0.248796181668049,	-0.185237781338740,	0.0487725805040312,	0.106888773357571,	-0.220480316087089,	0.247294127491195,	-0.176776695296636,	0.0366826186138399,	0.117849184206500,	-0.225997323280861,	0.245196320100808,	-0.167889738711754,	0.0245042850823900,	0.128525686048306,	-0.230969883127822,	0.242507813298636,	-0.158598321040910,	0.0122669185818547,	0.138892558254902,	-0.235386016295755,	0.239235083933052,	-0.148924826123109},
            {0.176776695296637,	-0.214432152500068,	0.117849184206499,	0.0122669185818545,	-0.138892558254901,	0.225997323280861,	-0.248796181668049,	0.200801882870161,	-0.0956708580912724,-0.0366826186138405,0.158598321040911,	-0.235386016295755,	0.245196320100808,	-0.185237781338740,	0.0725711693136154,	0.0607450449758170,	-0.176776695296637,	0.242507813298636,	-0.239235083933052,	0.167889738711754,	-0.0487725805040318,-0.0842224633480544,0.193252613340684,	-0.247294127491195,	0.230969883127822,	-0.148924826123109,	0.0245042850823916,	0.106888773357572,	-0.207867403075636,	0.249698864051293,	-0.220480316087088,	0.128525686048304},
            {0.176776695296637,	-0.225997323280861,	0.158598321040911,	-0.0607450449758161,-0.0487725805040320,0.148924826123108,	-0.220480316087089,	0.249698864051293,	-0.230969883127822,	0.167889738711755,	-0.0725711693136155,-0.0366826186138406,0.138892558254900,	-0.214432152500068,	0.248796181668049,	-0.235386016295755,	0.176776695296637,	-0.0842224633480552,-0.0245042850823901,0.128525686048305,	-0.207867403075636,	0.247294127491195,  -0.239235083933052,	0.185237781338739,	-0.0956708580912736,-0.0122669185818533,0.117849184206498,	-0.200801882870161,	0.245196320100807,	-0.242507813298636,	0.193252613340685,	-0.106888773357571},
            {0.176776695296637,	-0.235386016295755,	0.193252613340684,	-0.128525686048305,	0.0487725805040318,	0.0366826186138409,	-0.117849184206500,	0.185237781338740,	-0.230969883127822,	0.249698864051293,	-0.239235083933052,	0.200801882870161,	-0.138892558254900,	0.0607450449758146,	0.0245042850823909,	-0.106888773357572,	0.176776695296638,	-0.225997323280861,	0.248796181668049,	-0.242507813298636,	0.207867403075635,	-0.148924826123107,	0.0725711693136135,	0.0122669185818578,	-0.0956708580912732,0.167889738711756,	-0.220480316087090,	0.247294127491195,	-0.245196320100807,	0.214432152500067,	-0.158598321040909,	0.0842224633480539},
            {0.176776695296637,	-0.242507813298636,	0.220480316087089,	-0.185237781338740,	0.138892558254900,	-0.0842224633480546,0.0245042850823903,	0.0366826186138405,	-0.0956708580912728,0.148924826123109,	-0.193252613340685,	0.225997323280861,	-0.245196320100808,	0.249698864051293,	-0.239235083933052,	0.214432152500068,	-0.176776695296636,	0.128525686048305,	-0.0725711693136144,0.0122669185818530,	0.0487725805040338,	-0.106888773357571,	0.158598321040912,	-0.200801882870162,	0.230969883127821,	-0.247294127491195,	0.248796181668049,	-0.235386016295755,	0.207867403075636,	-0.167889738711753,	0.117849184206499,  -0.0607450449758132},
            {0.176776695296637,	-0.247294127491195,	0.239235083933052,	-0.225997323280861,	0.207867403075636,	-0.185237781338740,	0.158598321040911,	-0.128525686048306,	0.0956708580912723,	-0.0607450449758155,0.0245042850823902,	0.0122669185818539,	-0.0487725805040327,0.0842224633480551,	-0.117849184206499,	0.148924826123109,	-0.176776695296637,	0.200801882870161,	-0.220480316087089,	0.235386016295755,	-0.245196320100808,	0.249698864051293,	-0.248796181668049,	0.242507813298636,	-0.230969883127821,	0.214432152500068,	-0.193252613340684,	0.167889738711755,	-0.138892558254901,	0.106888773357569,	-0.0725711693136141,0.0366826186138394},
            {0.176776695296637,	-0.249698864051293,	0.248796181668049,	-0.247294127491195,	0.245196320100808,	-0.242507813298636,	0.239235083933052,	-0.235386016295755,	0.230969883127822,	-0.225997323280861,	0.220480316087089,	-0.214432152500068,	0.207867403075636,	-0.200801882870161,	0.193252613340685,	-0.185237781338740,	0.176776695296637,	-0.167889738711754,	0.158598321040911,	-0.148924826123109,	0.138892558254901,	-0.128525686048307,	0.117849184206500,	-0.106888773357571,	0.0956708580912727,	-0.0842224633480549,0.0725711693136150,	-0.0607450449758150,0.0487725805040341,	-0.0366826186138421,0.0245042850823914,	-0.0122669185818553}
    };

    void MultiplyMatrix(float *matrix1, float *matrix2, float *result, int window_size){
        float sum = 0;
        for(int i = 0; i < window_size; i++)
            for(int j = 0; j < window_size; j++) {
                for(int k = 0; k < window_size; k++){
                    sum += *(matrix1+(window_size*i)+k) * (*(matrix2+(window_size*k)+j));
                }
                *(result+(window_size*i)+j) = sum;
                sum = 0;
            }
    }

    void getImageBlock(uint8_t* image, int i_, int j_, int image_width, int window_size, float* block) {
        for (int i = i_; i < window_size+i_; i++)
            for (int j = j_; j < (window_size)+j_; j++) {
                block[window_size * (i-i_) + (j - j_)] = ((float) image[(image_width * (i)) + (j)]);
            }
    }

    float* DCT(float* block_, int width_, int height_) {
        float *DCT_creator_mtx;
        float *DCT_creator_mtx_T;
        if (width_ == height_) {
            switch (width_) {
                case 2:
                    DCT_creator_mtx = &DCT_Creator2[0][0];
                    DCT_creator_mtx_T = &DCT_Creator2_T[0][0];
                    break;
                case 4:
                    DCT_creator_mtx = &DCT_Creator4[0][0];
                    DCT_creator_mtx_T = &DCT_Creator4_T[0][0];
                    break;
                case 8:
                    DCT_creator_mtx = &DCT_Creator8[0][0];
                    DCT_creator_mtx_T = &DCT_Creator8_T[0][0];
                    break;
                case 16:
                    DCT_creator_mtx = &DCT_Creator16[0][0];
                    DCT_creator_mtx_T = &DCT_Creator16_T[0][0];
                    break;
                case 32:
                    DCT_creator_mtx = &DCT_Creator32[0][0];
                    DCT_creator_mtx_T = &DCT_Creator32_T[0][0];
                    break;
            }
        }

        float *block = new float[width_*width_];
        float *temp = new float[width_*width_];

        MultiplyMatrix(DCT_creator_mtx, block_, temp, width_);
        MultiplyMatrix(temp, DCT_creator_mtx_T, block, height_);   // D*A*D'

        return block;
    }

    float* ADCT(float* i_block, int width_, int height_){
        float *DCT_creator_mtx;
        float *DCT_creator_mtx_T;
        if (width_ == height_) {
            switch (width_) {
                case 2:
                    DCT_creator_mtx = &DCT_Creator2[0][0];
                    DCT_creator_mtx_T = &DCT_Creator2_T[0][0];
                    break;
                case 4:
                    DCT_creator_mtx = &DCT_Creator4[0][0];
                    DCT_creator_mtx_T = &DCT_Creator4_T[0][0];
                    break;
                case 8:
                    DCT_creator_mtx = &DCT_Creator8[0][0];
                    DCT_creator_mtx_T = &DCT_Creator8_T[0][0];
                    break;
                case 16:
                    DCT_creator_mtx = &DCT_Creator16[0][0];
                    DCT_creator_mtx_T = &DCT_Creator16_T[0][0];
                    break;
                case 32:
                    DCT_creator_mtx = &DCT_Creator32[0][0];
                    DCT_creator_mtx_T = &DCT_Creator32_T[0][0];
                    break;
            }
        }

        float *block = new float[width_*width_];
        float *temp = new float[width_*width_];

        MultiplyMatrix(i_block, DCT_creator_mtx, temp, width_);
        MultiplyMatrix(DCT_creator_mtx_T, temp, block, width_);

        return block;
    }

    void applyDCTToColor(uint8_t* Color, int window_size, int sigma){
        float* block = new float[window_size];
        float* DCT_arr;
        const float thr = 2.7 * sigma;

        for(int i = 0; i < im_height; i+=window_size){
            for(int j = 0; j < im_width; j+=window_size){
                getImageBlock(Color, i, j, im_width, window_size, block);
                DCT_arr = DCT(block, window_size, window_size);
                for(int z = 0; z < window_size*window_size; z++){
                    if(DCT_arr[z] > thr) DCT_arr[z] = 0;
                }
                block = ADCT(DCT_arr, window_size, window_size);
                int s = 0;
                for(int z = i; z < i + window_size; z++)
                {
                    for(int l = j; l < j + window_size; l++)
                    {
                        Color[(z*im_width) + l] = (uint8_t)block[s];
                        s++;
                    }
                }
            }
        }
    }

    
    EMSCRIPTEN_KEEPALIVE
    bool applyDCTFilter(int window_size, int sigma){
        if(buffer_R != nullptr) applyDCTToColor(buffer_R, window_size, sigma);
        if(buffer_G != nullptr) applyDCTToColor(buffer_G, window_size, sigma);
        if(buffer_R != nullptr) applyDCTToColor(buffer_B, window_size, sigma);
        return true;
    }
}